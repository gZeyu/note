### ~~用户管理(方案1)~~
- ~~因为个人用户、商家用户和管理员三者涉及到的业务、功能交叉不大，再加上安全上的考虑，为这三者分开建表。~~
- 采用`RBAC`进行权限管理
	- 由于会员、积分、黑名单等原因，不同个人用户的权限会有区别
	- 由于策略、黑名单等原因，不同商家用户的权限会有区别
```
o_user(id, nickname, phone_number, password, salt, avatar, score)
o_user_address(id, user_id, address_id)
o_role(id, role_name)
o_permission(id, description)
o_user_role(id, user_id, role_id)
o_role_permission(id, role_id, permission_id)
o_shop(id, shop_name, phone_number, password, salt, avatar, info, announcement, score, shipping_fee)
o_shop_role(id, user_id, role_id)
o_admin(id, admin_name, password, salt)
o_admin_role(id, user_id, role_id)
```
### 用户管理(方案2)
- 商铺和店长是两个不同的实体，商铺的店长是可更换的，所以方案1用`o_shop`一张表存储商家和店长信息不太好，应该分两张表单独存，再关联起来
- 从个人用户、商家用户和管理员中抽取通用的用户表，做登录和鉴权
- 采用`RBAC`进行权限管理
	- 由于会员、积分、黑名单等原因，不同个人用户的权限会有区别
	- 由于策略、黑名单等原因，不同商家用户的权限会有区别
#### 登录和鉴权
```
o_user(id, username, nickname, phone_number, password, salt, avatar, score, status)
o_role(id, role_name)
o_permission(id, permission_name, method, url, description)
o_user_role(id, user_id, role_id)
o_role_permission(id, role_id, permission_id)
```
- 一个用户可能有多个地址
#### 收货地址
```
o_user_address(id, user_id, address)
```
#### 店铺收藏
```
o_shop_collection(id, user_id, shop_id)
```
### 店铺管理
```
o_favorite_shop(id, user_id, shop_id)
```

### 菜单管理
菜单目录和产品是多对多的关系
```
o_product(id, name, image, price, like, sales)
```
```
o_shop_menu(id, item)
```
```
o_shop_menu_product(id, menu)
```
### 订单管理

```
o_order(id, order_no, user_id, username, phone_number, address, products, full_reduction_offer, coupon, total_price)
```

### 评论管理
```
o_user_comment(id, user_id, shop_id, order_id, content, score, like)
o_shop_reply(id, user_comment_id, shop_id, content)
```
### 优惠政策
### 红包

> 上述关系模式皆省略`create_by, modified_by, gmt_create, gmt_modified`属性。

<!--stackedit_data:
eyJoaXN0b3J5IjpbNzkyOTc5NDU0LDMwMDM5NjM2MiwtMTMxMT
UzNTUyMCwxNjg4MTc1ODU5LC0yMDAzMTY2NjI5LC01NTg5OTY3
MDcsMTA5NzgxODQzNSwyMDE5ODIzMTMsLTE3NzQ0MDM3MzQsMT
g3ODY3NTU3NCwtMTgzODA0MjUwNiwtMTY2MjEyODQyMSwtMzA1
NjUxNjAyLC0xODQ5NzM3MzIsMTMzMjU3MTAzLC00OTE3ODI0Mz
YsMTA1NzU1MTk4OSwxMjI4NTUwODQ0LC0xMTIxOTM3NDk5LDE5
NDQ1MDg3NDZdfQ==
-->